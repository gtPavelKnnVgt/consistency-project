lowercaseOutputName: true
rules:
  # Kafka metrics
  - pattern: "kafka.server<type=BrokerTopicMetrics, name=MessagesInPerSec><>Count"
    name: kafka_server_brokertopicmetrics_messagesin_total
    type: COUNTER
  - pattern: "kafka.server<type=BrokerTopicMetrics, name=BytesInPerSec><>Count"
    name: kafka_server_brokertopicmetrics_bytesin_total
    type: COUNTER
  - pattern: "kafka.server<type=BrokerTopicMetrics, name=BytesOutPerSec><>Count"
    name: kafka_server_brokertopicmetrics_bytesout_total
    type: COUNTER
  - pattern: "kafka.network<type=RequestMetrics, name=RequestsPerSec, request=(.+)><>Count"
    name: kafka_network_requestmetrics_requests_total
    labels:
      request: "$1"
    type: COUNTER
  - pattern: "kafka.network<type=RequestMetrics, name=TotalTimeMs, request=(.+), quantile=(.+)><>Value"
    name: kafka_network_requestmetrics_totaltimems
    labels:
      request: "$1"
      quantile: "$2"
    type: GAUGE

  # Cluster health metrics
  - pattern: "kafka.server<type=ReplicaManager, name=LeaderCount><>Value"
    name: kafka_server_replicamanager_leadercount
    type: GAUGE
  - pattern: "kafka.server<type=ReplicaManager, name=UnderReplicatedPartitions><>Value"
    name: kafka_server_replicamanager_underreplicatedpartitions
    type: GAUGE

  # JVM metrics
  - pattern: "java.lang<type=Memory, name=HeapMemoryUsage, key=used><>Value"
    name: jvm_memory_bytes_used
    type: GAUGE
  - pattern: "java.lang<type=Threading><>ThreadCount"
    name: jvm_threads_current
    type: GAUGE
  - pattern: "java.lang<type=OperatingSystem, name=ProcessCpuTime><>Value"
    name: process_cpu_seconds_total
    type: COUNTER
